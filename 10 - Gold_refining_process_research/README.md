# Восстановление золота из руды

### Статус проекта

`Завершен`

### Исследование технологического процесса очистки золота 

`Pandas`, `Matplotlib`, `NumPy`, `Sklearn`, `Seaborn`

## Цель

Необходимо подготовить прототип модели машинного обучения для «Цифры». Компания разрабатывает решения для эффективной работы промышленных предприятий.
Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Для работы используем данные с параметрами добычи и очистки.
Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

## Итоги

Задачей данной работы было построение модели, которая бы предсказывала эффективность обогащения золотосодержащей руды на этапах флотации и очистки.

В результате выполнения работы было сделано и выявлено следующее:
1. На первом этапе:
    - была проведен загрузка и изучены данные. Для каждого из датасетов был подготовлен EDA отчёт;
        - проверку корректности расчета эффективность обогащения; 
        - анализ признаков недоступных в тестовой выборке;
    - была проведена предобработка данных, в т.ч.:
        - обработаны пропуски
        - заменены типы данных для признака date
        - подготовлена обучающая и тестовая выборки для дальнейшей работы: в обоих выборках оставлено одинаковое количество признаков и получено подтверждение, что они не коррелируют с целевыми признаками.

2. На втором этапе:
   - была проведена проверка, как меняется концентрация металлов (Au, Ag, Pb) на различных этапах очистки;
        Сделан вывод о том, что концентрация каждого из металлов меняется в зависимости от этапа очистки. Так, например, концентрация золота постепенно увеличивается с каждым этапом, а серебра — падает на каждом этапе, свинца - на первых трех этапах растет, а потом стабилизируется. В финальном концентрате медианный показатель концентрации свинца почти такой же, как на предыдущем шаге, но при этом на финальной стадии гораздо ниже показатель разброса значений.
При этомна всех этапах очистки в данных присутствуют выбросы.
    - был проведен анализ размера гранул на обучающей и тестовой выборках и был сделан вывод о том, что размеры гранул примерно одинаково распределены в обоих выборках.
    - был проведен проведен анализ суммарной концентрации всех металлов на разных стадиях, были обнаружены и удалены аномалии из всех датасетов.
   
3. На третьем этапе:
     - созданы функции для расчёта sMAPE и итоговой sMAPE
     - проведено сравнение работы разных моделей (DecisionTreeRegressor (), RandomForestRegressor, LinearRegression);
     - проведено тестирование модель случайного леса с гиперпараметрами n_estimators = 20 и max_depth = 3 на тестовой выборке и проверили модель на адекватность. 
      Сделалн вывод, что обученная модель работает лучше чем константная модель: ошибка обученной модели составляет 7,04%, константной - 7.68%.
     
