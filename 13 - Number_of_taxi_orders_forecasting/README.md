# Прогнозирование количества заказов такси на следующий час

### Статус проекта

`Завершен`

### Используемые инструменты

`Pandas`, `Sklearn`, `Statsmodels`, `Matplotlib`, `Numpy`, `Seaborn`, `Catboost`, `Lighgbm`

## Цель

Компания «Чётенькое такси» собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Построим модель для такого предсказания.

Требование заказчика - значение метрики RMSE на тестовой выборке должно быть не больше 48.

## Итоги

В данном проекте были построены модели, предсказывающие спрос на такси.

1. На этапах изучения, ресемплирования и анализа данных:
    - проанализирован исторический набор данных по заказам такси; 
    - произведена предобработка и разведывательный анализ данных, ресемплирование данных по 1 часу и по 1 дню;
    - выявлена трендовая составляющая и сезонные тенденции, наблюдаемые в течение дня и в течение недели.

2. На этапах построения и исследования:
    - построены признаки для последующего прогнозирования количества заказов - час, день, месяц, скользящее среднее и отстающие значения количества заказов с 1 до 48 часов;
    - количество отстающих признаков определно по результатам предварительного анализа на модели линейной регрессии и использовано в дальнейшем и для других моделей;
    - проведено исследование трех моделе: линейной регрессия, случайного леса и градиентного бустинга (с использованием модели LGBMRegressor);
    - определена важность признаков для каждого типа моделей: для случайного леса и градиентного бустинга наиболее важными параметрами оказались отстающие значения количества заказов такси на 48 и на 24 часов, а также скользящее среднее и количество заказов за предыдущий час, для линейной регрессии - скользящее среднее и несколько значений отстающих признаков;
    - для моделей случайного леса и градиентного бустинга произведен перебор некоторых гиперпараметров для обучающей выборки на кросс-валидации. Однако засчет оптимизации гиперпараметров получен лишь незначительный прирост качества;

3. На этапе тестирования моделей:
    - произведено обучение моделей на всем наборе обучающих данных (для моделей случайного леса и градиентного бустинга с использованием подобранных гиперпараметров), расчет метрики RMSE на тестовом наборе и расчет времени обучения и предсказания;
    - по всем моделям получено значение RMSE для тестовой выборки менее 48 часов;
    - наилучшее значение метрики RMSE, равное 39.455, а также сравнительно низкое время обучения получено на модели градиентного бустинга (LGBMRegressor). С учетом совокупности результирующих параметров указанная модель может быть рекомендована для прогноза количества заказов.
